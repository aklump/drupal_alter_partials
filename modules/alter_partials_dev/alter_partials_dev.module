<?php
/**
 * @file
 * Base file for the alter_partials_dev module.
 *
 * @defgroup alter_partials_dev Alter Partials Dev
 * @{
 */

function alter_partials_dev_stub($path_to_output, array $vars) {
  $filename = str_replace('--', ', ', pathinfo($vars['partial'], PATHINFO_FILENAME));
  $vars = array_keys($vars);
  sort($vars);
  $list = array_reduce(array_filter($vars, function ($var) {
    return !in_array($var, ['partials']);
  }), function ($carry, $var) {
    $type = gettype($var);

    return $carry . "\n *   - \$$var $type";
  });
  $stub = <<<EOD
<?php
/**
 * @file Alter partial for {$filename}
 *       
 * Available variables:{$list} 
 */

EOD;
  \Drupal::moduleHandler()
    ->alter('alter_partials_dev_stub', $stub, $path_to_output);
  $stub .= PHP_EOL . PHP_EOL . PHP_EOL . file_get_contents($path_to_output);
  file_put_contents($path_to_output, $stub);
}

